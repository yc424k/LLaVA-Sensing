# LLaVA-NeXT μ„Όμ„-λ¬Έν•™ λ³€ν™ ν”„λ΅μ νΈ νμλ΅

**λ‚ μ§**: 2025-09-03  
**ν”„λ΅μ νΈ**: LLaVA-NeXT κΈ°λ° μ„Όμ„ λ°μ΄ν„°λ¥Ό λ¬Έν•™μ  λ‹¨λ½μΌλ΅ λ³€ν™ν•λ” AI λ¨λΈ κ°λ°  
**λ©μ **: λ΅λ΄‡μ ν™κ²½ μ„Όμ„ λ°μ΄ν„°λ¥Ό μ†μ„¤κ°€μ 'μκ°'μ²λΌ ν™μ©ν• λ¬Έν•™ μƒμ„±

---

## π“‹ ν”„λ΅μ νΈ κ°μ”

### μ—°κµ¬ λ©ν‘
- λ΅λ΄‡μ΄ μμ§‘ν• μ‹¤μ„Έκ³„ μ„Όμ„ λ°μ΄ν„°(μ΄λ―Έμ§€, μ¨μµλ„, λ°”λ, IMU)λ¥Ό ν™μ©
- μΈκ°„ μ†μ„¤κ°€μ 'μκ°'μ²λΌ μ‘μ©ν•μ—¬ ν’λ¶€ν•κ³  κ°κ°μ μΈ λ¬Έν•™μ  λ‹¨λ½ μƒμ„±
- λ¨λ”λ‹μ¦ μ†μ„¤κ³Ό μ—¬ν–‰κΈ° μ¤νƒ€μΌ ν•™μµμ„ ν†µν• κ³ ν’μ§ λ¬Έν•™μ  ν‘ν„

### ν•µμ‹¬ μ„Όμ„ κµ¬μ„±
- **μ¨μµλ„ μ„Όμ„**: μ¨λ„μ™€ μµλ„ μΈ΅μ •
- **λ°”λ μ„Όμ„**: λ°”λ λ°©ν–¥λ§ μΈ΅μ • (μ†λ„ μ •λ³΄ μ—†μ)
- **IMU μ„Όμ„**: κ°€μ†λ„κ³„ + μμ΄λ΅μ¤μ½”ν”„λ΅ λ΅λ΄‡ λ°©ν–¥ μ¶”μ •
- **μ΄λ―Έμ§€**: κΈ°μ΅΄ LLaVA-NeXT μ‹κ° μ²λ¦¬ ν™μ©

### μ£Όμ” νμ‹ μ 
- **μ£Όκ΄€μ  λ°”λ κ³„μ‚°**: IMUλ¥Ό ν†µν•΄ λ΅λ΄‡ κΈ°μ¤€ μƒλ€μ  λ°”λ λ°©ν–¥ κ³„μ‚°
- **λ©€ν‹°λ¨λ‹¬ μµν•©**: κ° μ„Όμ„ λ°μ΄ν„°λ¥Ό λ³„λ„ μ±„λ„λ΅ μ²λ¦¬ ν›„ μµν•©
- **λ¬Έν•™μ  λ³€ν™**: μ„Όμ„ λ°μ΄ν„° β†’ κ°κ°μ  λ¬Έν•™ λ¬μ‚¬

---

## π”§ κΈ°μ μ  κµ¬ν„ λ‚΄μ©

### 1. μ„Όμ„ μΈμ½”λ” μ„¤κ³„
#### νμΌ: `environmental_sensor_encoder.py`
- **κ°λ³„ μ„Όμ„ μ„λ² λ”©**: μ¨λ„, μµλ„, λ°”λλ°©ν–¥, IMU κ°κ° Neural Networkλ΅ μΈμ½”λ”©
- **μƒλ€ λ°”λ κ³„μ‚°**: `compute_robot_relative_wind()` ν•¨μλ΅ λ΅λ΄‡ κΈ°μ¤€ λ°”λλ°©ν–¥ κ³„μ‚°
- **ν¬λ΅μ¤λ¨λ‹¬ μ–΄ν…μ…**: 5κ° μ„Όμ„ λ¨λ‹¬λ¦¬ν‹° κ°„ μƒνΈμ‘μ© ν•™μµ
- **μµμΆ… ν”„λ΅μ μ…**: LLaVA-NeXT hidden_size(4096)λ΅ λ§¤ν•‘

#### νμΌ: `wind_calculation.py`
- **IMU ν•„ν„°λ§**: λ…Έμ΄μ¦ μ κ±°λ¥Ό μ„ν• μ΄λ™ν‰κ·  ν•„ν„°
- **λ°©ν–¥ μ¶”μ •**: κ°€μ†λ„κ³„μ™€ μμ΄λ΅μ¤μ½”ν”„ μµν•©μΌλ΅ λ΅λ΄‡ heading κ³„μ‚°
- **8λ°©ν–¥ λ¬Έν•™μ  ν‘ν„**: "μ •λ©΄μ—μ„ λ§μ£ΌμΉλ”", "λ’¤μ—μ„ λ– λ―Έλ”" λ“± ν•κµ­μ–΄ κ°κ° ν‘ν„
- **ν™κ²½ μ„Όμ„ ν†µν•© μ²λ¦¬**: μ¨λ„, μµλ„, λ°”λμ„ μΆ…ν•©ν• λ¬Έν•™μ  μ»¨ν…μ¤νΈ μƒμ„±

### 2. λ°μ΄ν„°μ…‹ μƒμ„± νμ΄ν”„λΌμΈ

#### μ½”νΌμ¤ κΈ°λ° μ ‘κ·Όλ²• μ±„νƒ
- **λ°μ΄ν„° μ†μ¤**: `/Novel/Modernist_Novel` (202κ°) + `/Travel_Novel` (201κ°) = μ΄ 403κ° νμΌ
- **μ‹¤μ  μ²λ¦¬**: ν…μ¤νΈλ΅ 6κ° νμΌ μ²λ¦¬ β†’ 1,874κ° ν•™μµ λ°μ΄ν„° μƒμ„±

#### ν•µμ‹¬ μ•κ³ λ¦¬μ¦: ν‚¤μ›λ“ κΈ°λ° κ°κ° λ¶„μ„
```python
# μ¨λ„ ν‚¤μ›λ“
'hot': ['hot', 'warm', 'burning', 'blazing', 'scorching']
'cold': ['cold', 'cool', 'chilly', 'freezing', 'icy']

# μµλ„ ν‚¤μ›λ“  
'humid': ['humid', 'moist', 'damp', 'wet', 'steamy']
'dry': ['dry', 'arid', 'parched', 'dusty']

# μ²λ¦¬ νλ¦„: ν‚¤μ›λ“ λΉλ„ β†’ κ°•λ„ νμ • β†’ μ„Όμ„κ°’ λ²”μ„ β†’ λλ¤κ°’ μƒμ„±
```

#### νμΌ κµ¬μ΅°
- `simple_novel_processor.py`: μμ΅΄μ„± μ—†λ” κΈ°λ³Έ μ²λ¦¬κΈ°
- `novel_corpus_processor.py`: NumPy λ“± κ³ κΈ‰ λΌμ΄λΈλ¬λ¦¬ ν™μ© μ²λ¦¬κΈ°
- `preprocess_with_args.py`: ν†µν•© μ‹¤ν–‰ μ¤ν¬λ¦½νΈ (λ‘ λ¨λ“ μ§€μ›)

### 3. λ°μ΄ν„° μµμ ν™”

#### μ²­ν¬ λ¶„ν•  μ‹μ¤ν…
- **λ¬Έμ **: 93MB λ‹¨μΌ JSON νμΌ β†’ λ©”λ¨λ¦¬ λ¶€λ‹΄
- **ν•΄κ²°**: 100κ°μ”© μ²­ν¬ λ¶„ν•  β†’ 19κ° μ²­ν¬ νμΌ (κ° ~190KB)
- **μλ™ν™”**: λ°μ΄ν„° μƒμ„± ν›„ μλ™ μ²­ν¬ λ¶„ν•  κΈ°λ¥ ν†µν•©

#### μ—°κµ¬ λ©μ  μµμ ν™”
- **μ‚¬μ©μ ν™κ²½**: LLM ν›λ ¨, λ…Όλ¬Έ μ¶ν, 128GB λ©”λ¨λ¦¬
- **κ¶μ¥ μ²­ν¬ ν¬κΈ°**: 2,500κ° (λ…Όλ¬Έ λ³΄κ³ μ— μ μ , ν¨μ¨μ  λ°°μΉ μ²λ¦¬)
```bash
python3 preprocess_with_args.py --max_files 202 --chunk_size 2500 --verbose
```

---

## π“ λ°μ΄ν„°μ…‹ λ¶„μ„

### μƒμ„±λ λ°μ΄ν„° κµ¬μ΅°
```json
{
  "id": "A001_passage_001",
  "sensor_data": {
    "temperature": 23.5,      // Β°C
    "humidity": 65.2,         // %
    "wind_direction": 1.57,   // radians
    "imu": [0.1, 0.05, 9.8, 0.01, 0.02, 0.1], // [acc_x,y,z, gyro_x,y,z]
    "context": {
      "scenario": "city_walking",
      "time": "afternoon", 
      "weather": "clear"
    }
  },
  "target_paragraph": "μ‹¤μ  λ¬Έν•™ ν…μ¤νΈ...",
  "metadata": {
    "source_file": "A001_The_Awakening.txt",
    "style_category": "modernist",
    "sensory_analysis": {...}
  }
}
```

### λ°μ΄ν„° ν’μ§ μ§€ν‘
- **μ΄ 1,874κ° μμ‹** (6κ° νμΌ κΈ°μ¤€)
- **μ¤νƒ€μΌ λ¶„ν¬**: λ¨λ”λ‹μ¦ 1,048κ°, μ—¬ν–‰κΈ° 826κ°  
- **μ¨λ„ λ²”μ„**: 5.0Β°C ~ 34.5Β°C
- **μµλ„ λ²”μ„**: 21.0% ~ 89.4%
- **ν‰κ·  λ‹¨λ½ κΈΈμ΄**: 511μ

### μ „μ²΄ λ°μ΄ν„° κ·λ¨ μ¶”μ •
- **403κ° νμΌ μ²λ¦¬ μ‹**: μ•½ 125,000κ° λ°μ΄ν„°μ…‹ μμƒ
- **μ²λ¦¬ μ‹κ°„**: 10-30λ¶„ μ†μ” μμƒ

---

## π—οΈ μ•„ν‚¤ν…μ² ν†µν•© κ³„ν

### LLaVA-NeXT ν™•μ¥
1. **κΈ°μ΅΄ κµ¬μ΅° λ¶„μ„**: `llava_arch.py`μ `prepare_inputs_labels_for_multimodal()` ν•¨μ ν™•μ¥μ  νμ•…
2. **μ„Όμ„ μΈμ½”λ” μ¶”κ°€**: ν™κ²½ μ„Όμ„λ¥Ό μƒλ΅μ΄ λ¨λ‹¬λ¦¬ν‹°λ΅ ν†µν•©
3. **builder.py ν™•μ¥**: μ„Όμ„ νƒ€μ› λΉλ” μ¶”κ°€

### ν›λ ¨ νμ΄ν”„λΌμΈ
- **λ©€ν‹°λ¨λ‹¬ μ…λ ¥**: [μ΄λ―Έμ§€] + [μ„Όμ„ λ°μ΄ν„°] + [ν…μ¤νΈ ν”„λ΅¬ν”„νΈ] β†’ [λ¬Έν•™μ  λ‹¨λ½]
- **μ†μ‹¤ ν•¨μ**: κΈ°μ΅΄ μ–Έμ–΄ λ¨λΈλ§ μ†μ‹¤ ν™μ©
- **ν‰κ°€ μ§€ν‘**: BLEU, ROUGE, λ¬Έν•™μ  ν’μ§ ν‰κ°€

---

## π› οΈ κ°λ°λ λ„κµ¬λ“¤

### μ‹¤ν–‰ μ¤ν¬λ¦½νΈ
- `preprocess_with_args.py`: λ©”μΈ μ‹¤ν–‰ μ¤ν¬λ¦½νΈ
- `run_preprocessing.sh`: λ°°μΉ μ²λ¦¬ μ¤ν¬λ¦½νΈ  
- `split_dataset.py`: μ²­ν¬ λ¶„ν•  μ ν‹Έλ¦¬ν‹°
- `dataset_reader.py`: μ²­ν¬ λ°μ΄ν„° μ½κΈ° λ„κµ¬

### λ¬Έμ„ν™”
- `README.md`: μΆ…ν•© μ‹¤ν–‰ κ°€μ΄λ“
- `algorithm_explanation.md`: μ•κ³ λ¦¬μ¦ μƒμ„Έ μ„¤λ…
- `νμλ΅.md`: μ΄ νμΌ

---

## β… μ™„λ£λ μ‘μ—…

1. **β… LLaVA-NeXT μ•„ν‚¤ν…μ² λ¶„μ„**: λ©€ν‹°λ¨λ‹¬ ν†µν•© μ§€μ  νμ•…
2. **β… ν™κ²½ μ„Όμ„ μΈμ½”λ” μ„¤κ³„**: μ¨μµλ„, λ°”λ, IMU ν†µν•© μ²λ¦¬
3. **β… λ΅λ΄‡ μƒλ€ λ°”λ κ³„μ‚°**: IMU κΈ°λ° μ£Όκ΄€μ  λ°”λ λ°©ν–¥ κ³„μ‚°
4. **β… ν•©μ„± λ°μ΄ν„° μƒμ„± νμ΄ν”„λΌμΈ**: GPT-4/Claude κΈ°λ° λ°μ΄ν„° μƒμ„± μ‹μ¤ν…
5. **β… μ½”νΌμ¤ κΈ°λ° λ°μ΄ν„° μƒμ„±**: Novel ν΄λ” 403κ° νμΌ ν™μ© μ‹μ¤ν…
6. **β… λ°μ΄ν„° μ „μ²λ¦¬ μ‹¤ν–‰ κ°€μ΄λ“**: README λ° ν†µν•© μ¤ν¬λ¦½νΈ
7. **β… λ€μ©λ‰ λ°μ΄ν„° μ²­ν¬ λ¶„ν• **: λ©”λ¨λ¦¬ ν¨μ¨μ  λ°μ΄ν„° κ΄€λ¦¬
8. **β… λ°μ΄ν„° μµμ ν™”**: μ—°κµ¬ λ©μ μ— λ§λ” μ²­ν¬ ν¬κΈ° κ²°μ •

---

## π”„ μ§„ν–‰ μ¤‘μΈ μ‘μ—…

### 8. LLaVA-NeXT μ•„ν‚¤ν…μ² μ„Όμ„ λ¨λ‹¬λ¦¬ν‹° ν™•μ¥
- **μƒνƒ**: μ§„ν–‰ μ¤‘
- **λ‚΄μ©**: ν™κ²½ μ„Όμ„ μΈμ½”λ”λ¥Ό LLaVA-NeXTμ— ν†µν•©
- **λ‹¤μ λ‹¨κ³„**: 
  - `builder.py`μ— μ„Όμ„ νƒ€μ› μ¶”κ°€
  - `llava_arch.py`μ—μ„ μ„Όμ„ μ²λ¦¬ λ΅μ§ ν†µν•©
  - λ©€ν‹°λ¨λ‹¬ μ–΄ν…μ…μ— μ„Όμ„ μ±„λ„ μ¶”κ°€

---

## π“… ν–¥ν›„ κ³„ν

### 9. ν›λ ¨ νμ΄ν”„λΌμΈ μ„¤κ³„
- **λ©ν‘**: μ„Όμ„ λ°μ΄ν„° β†’ λ¬Έν•™ μƒμ„± λ¨λΈ ν›λ ¨ μ‹μ¤ν…
- **κµ¬μ„± μ”μ†**:
  - λ°μ΄ν„° λ΅λ” (μ²­ν¬ λ‹¨μ„ λ°°μΉ μ²λ¦¬)
  - ν›λ ¨ λ£¨ν”„ (λ©€ν‹°λ¨λ‹¬ μ…λ ¥ μ²λ¦¬)
  - ν‰κ°€ λ©”νΈλ¦­ (λ¬Έν•™μ  ν’μ§ μΈ΅μ •)
  - μ²΄ν¬ν¬μΈνΈ κ΄€λ¦¬

### μ¶”κ°€ κ°μ„ μ‚¬ν•­
- **λ°μ΄ν„° ν’μ§ ν–¥μƒ**: λ” μ •κµν• μ„Όμ„-λ¬Έν•™ λ§¤ν•‘ μ•κ³ λ¦¬μ¦
- **λ‹¤κµ­μ–΄ ν™•μ¥**: μμ–΄, μΌλ³Έμ–΄ λ¬Έν•™ μ½”νΌμ¤ μ¶”κ°€
- **μ‹¤μ‹κ°„ μƒμ„±**: λ΅λ΄‡ μ„Όμ„ λ°μ΄ν„° μ‹¤μ‹κ°„ λ¬Έν•™ λ³€ν™
- **ν‰κ°€ μ‹μ¤ν…**: λ¬Έν•™ μ „λ¬Έκ°€ ν‰κ°€ + μλ™ ν‰κ°€ κ²°ν•©

---

## π’΅ μ£Όμ” μΈμ‚¬μ΄νΈ

### κΈ°μ μ  νμ‹ 
1. **μ„Όμ„ μµν•©μ λ¬Έν•™μ  ν™μ©**: κΈ°μ΅΄ μ„Όμ„ μµν•©μ΄ κ°κ΄€μ  μ •λ³΄ μ¶”μ¶μ— μ§‘μ¤‘ν–λ‹¤λ©΄, μ΄ ν”„λ΅μ νΈλ” μ£Όκ΄€μ  κ°κ° ν‘ν„μ— ν™μ©
2. **μƒλ€μ  ν™κ²½ μΈμ‹**: λ΅λ΄‡ κΈ°μ¤€μ μ£Όκ΄€μ  λ°”λ λ°©ν–¥ κ³„μ‚°μΌλ΅ μΈκ°„μ  κ°κ° λ¨μ‚¬
3. **μ½”νΌμ¤ κΈ°λ° ν•™μµ**: μ‹¤μ  λ¬Έν•™ μ‘ν’μ—μ„ μ¶”μ¶ν• μμ—°μ¤λ¬μ΄ ν‘ν„ ν™μ©

### μ—°κµ¬ κ°€μΉ  
1. **λ΅λ΄‡ κ°μ„± ν‘ν„**: λ΅λ΄‡μ΄ ν™κ²½μ„ μΈκ°„μ μΌλ΅ ν‘ν„ν•λ” μƒλ΅μ΄ μ ‘κ·Όλ²•
2. **λ©€ν‹°λ¨λ‹¬ μ°½μ‘**: μ„Όμ„ λ°μ΄ν„°λ¥Ό μ°½μ‘μ μκ°μΌλ΅ ν™μ©ν•λ” AI μ‹μ¤ν…
3. **λ¬Έν™”μ  AI**: νΉμ • λ¬Έν™”(ν•κµ­μ–΄)μ κ°κ° ν‘ν„μ„ ν•™μµν•λ” λ¨λΈ

---

## π”§ κ°λ° ν™κ²½ λ° λ„κµ¬

### μ‚¬μ© κΈ°μ 
- **Python 3**: κΈ°λ³Έ κ°λ° μ–Έμ–΄
- **PyTorch**: λ”¥λ¬λ‹ ν”„λ μ„μ›ν¬ (LLaVA-NeXT κΈ°λ°)
- **JSON**: λ°μ΄ν„° μ €μ¥ ν¬λ§·
- **Bash**: μλ™ν™” μ¤ν¬λ¦½νΈ

### μμ΅΄μ„± κ΄€λ¦¬
- **Simple λ¨λ“**: ν‘μ¤€ λΌμ΄λΈλ¬λ¦¬λ§ μ‚¬μ© (numpy μ—†μ΄)
- **Advanced λ¨λ“**: numpy, pandas, nltk, scikit-learn ν•„μ”

### λ°μ΄ν„° κ΄€λ¦¬
- **μ›λ³Έ μ½”νΌμ¤**: 403κ° ν…μ¤νΈ νμΌ (93MB)
- **μ²λ¦¬ λ°μ΄ν„°**: μ²­ν¬ λ‹¨μ„ JSON νμΌλ“¤
- **λ°±μ—… μ „λµ**: μ›λ³Έ μ μ§€ + μ²­ν¬ λ¶„μ‚° μ €μ¥

---

## π“ ν–¥ν›„ ν‘μ—… λ°©μ•

### λ…Όλ¬Έ μ¶ν κ³„ν
- **ν•™ν**: AI/NLP κ΄€λ ¨ κµ­μ  ν•™ν (ACL, EMNLP, ICML λ“±)
- **μ£Όμ **: "Sensor-to-Literature: Environmental Perception as Creative Inspiration"
- **κΈ°μ—¬λ„**: μƒλ΅μ΄ λ©€ν‹°λ¨λ‹¬ μ°½μ‘ ν¨λ¬λ‹¤μ„ μ μ‹

### λ°μ΄ν„°μ…‹ κ³µκ°
- **GitHub**: μ „μ²λ¦¬ μ½”λ“ λ° λ„κµ¬ μ¤ν”μ†μ¤
- **Dataset**: μƒμ„±λ μ„Όμ„-λ¬Έν•™ λ°μ΄ν„°μ…‹ κ³µκ° (μ €μ‘κ¶ κ³ λ ¤)
- **μ¬ν„μ„±**: μ™„μ „ν• μ‹¤ν–‰ κ°€μ΄λ“ λ° ν™κ²½ μ„¤μ • μ κ³µ

---

**λ§μ§€λ§‰ μ—…λ°μ΄νΈ**: 2025-09-03  
**λ‹¤μ νμ**: LLaVA-NeXT μ•„ν‚¤ν…μ² μ„Όμ„ ν†µν•© μ™„λ£ ν›„